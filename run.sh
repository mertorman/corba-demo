#!/bin/bash

echo "🚀 CORBA Demo: Derleme ve Başlatma"
echo "-----------------------------------------------------------------------------------"
# 1️⃣ Eski derlemeleri temizle
echo "🧹 Temizleme işlemi..."
rm -rf bin
mkdir -p bin
echo "-----------------------------------------------------------------------------------"
# 2️⃣ Java dosyalarını derle
echo "-----------------------------------------------------------------------------------"
echo "🛠️  Derleme yapılıyor..."
javac -d bin $(find src/main/java -name "*.java")
echo "-----------------------------------------------------------------------------------"
# 3️⃣ ORBD servisini başlat (CORBA)
echo "-----------------------------------------------------------------------------------"
echo "                             🔵 ORBD başlatılıyor..."
orbd -ORBInitialPort 900 &  
sleep 2  
echo "-----------------------------------------------------------------------------------"
# 4️⃣ BServer'ı başlat
echo "-----------------------------------------------------------------------------------"
echo "                             🔵 BServer başlatılıyor..."
java -cp bin appB.server.BServer &
echo "-----------------------------------------------------------------------------------"
# 5️⃣ 2 saniye bekle, sonra AServer'ı başlat
sleep 2
echo "-----------------------------------------------------------------------------------"
echo "                             🟢 AServer başlatılıyor..."
java -cp bin appA.server.AServer &
echo "-----------------------------------------------------------------------------------"
# 6️⃣ 2 saniye bekle, sonra AClient çalıştır
sleep 2
echo "-----------------------------------------------------------------------------------"
echo "                             💻 AClient çalıştırılıyor..."
echo "-----------------------------------------------------------------------------------"
java -cp bin appA.AClient
echo "-----------------------------------------------------------------------------------"

echo "✅ Tüm işlemler tamamlandı."
